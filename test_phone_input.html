<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Phone Input Test</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                padding: 20px;
            }
            .phone-container {
                display: flex;
                align-items: center;
                margin: 20px 0;
            }
            .prefix {
                background: #f1f3f4;
                border: 1px solid #ccc;
                padding: 10px;
                border-radius: 4px 0 0 4px;
            }
            .phone-input {
                border: 1px solid #ccc;
                padding: 10px;
                border-radius: 0 4px 4px 0;
                border-left: none;
                width: 200px;
            }
            .test-result {
                margin: 10px 0;
                padding: 10px;
                border-radius: 4px;
            }
            .success {
                background: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }
            .info {
                background: #d1ecf1;
                color: #0c5460;
                border: 1px solid #bee5eb;
            }
        </style>
    </head>
    <body>
        <h1>Phone Input Validation Test</h1>

        <div class="test-result info">
            <strong>Test Instructions:</strong>
            <ul>
                <li>
                    Try typing letters, symbols, or special characters - they
                    should be blocked
                </li>
                <li>
                    Try typing more than 10 digits - input should be limited to
                    10
                </li>
                <li>Only numbers 0-9 should be allowed</li>
                <li>Phone must start with 9 and be exactly 10 digits</li>
            </ul>
        </div>

        <div class="phone-container">
            <span class="prefix">+63</span>
            <input
                type="text"
                class="phone-input"
                id="phone_local"
                placeholder="9171234567"
                pattern="^9\d{9}$"
                maxlength="10"
                inputmode="tel"
            />
        </div>

        <input type="hidden" id="phone_full" />

        <div id="output" class="test-result success">
            Full Phone: <span id="full-display">+63 </span>
        </div>

        <div class="test-result info">
            <strong>Validation Status:</strong>
            <span id="validation-status">Waiting for input...</span>
        </div>

        <script>
            // Same sync function as in register.php
            (function syncRegPhone() {
                const local = document.getElementById("phone_local");
                const full = document.getElementById("phone_full");
                const display = document.getElementById("full-display");
                const status = document.getElementById("validation-status");

                if (!local || !full) return;

                function update() {
                    // Allow only digits, remove everything else
                    let lp = local.value.replace(/\D/g, "");
                    // Limit to 10 digits max
                    if (lp.length > 10) lp = lp.slice(0, 10);
                    local.value = lp;
                    const fullPhone = "+63" + (lp ? " " + lp : " ");
                    full.value = fullPhone;
                    display.textContent = fullPhone;

                    // Validation feedback
                    if (lp.length === 0) {
                        status.textContent = "Waiting for input...";
                        status.style.color = "#666";
                    } else if (lp.length < 10) {
                        status.textContent = `Need ${
                            10 - lp.length
                        } more digits`;
                        status.style.color = "#856404";
                    } else if (!lp.startsWith("9")) {
                        status.textContent = "Must start with 9";
                        status.style.color = "#721c24";
                    } else {
                        status.textContent = "Valid phone number!";
                        status.style.color = "#155724";
                    }
                }

                local.addEventListener("input", update);
                local.addEventListener("keypress", function (e) {
                    // Allow only digits (0-9), backspace, delete, arrow keys
                    const char = String.fromCharCode(e.which);
                    if (!/[0-9]/.test(char) && e.which !== 8 && e.which !== 0) {
                        e.preventDefault();
                    }
                });
                local.addEventListener("blur", update);
                update();
            })();
        </script>
    </body>
</html>
